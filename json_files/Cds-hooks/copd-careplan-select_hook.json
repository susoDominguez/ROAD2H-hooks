{
  "hookInstance": "d1577c69-dfbe-44ad-ba6d-3e05e953b2ea", //required. unique id to be created for each hook request instance. If problematic, just use this one for all, as we dont work with live patients.
  "hook": "copd-careplan-select",
  "context": {
    "encounterId": "285064-0", //if system is not able to provide one for each encounter, just leave fixed
    "patientId": "1677163",
    "birthDate": "1970-10-03T00:00:00+01:00", //what's Heliant's preferred format? 
    "smokingStatus": {
      "resourceType": "Observation",
      "id": "smoking_status",
      "status": "final",
      "code": {
        "coding": [
          {
            "system": "https://www.snomed.org/",
            "code": "229819007",
            "display": "Tobacco use and exposure (observable entity)"
          }
        ],
        "text": "Smoking status" //text values are a customised rephrasing of the formal value (display above). In some cases could be same as display.
      },
      "valueCodeableConcept": {
        "coding": [
          {
            "system": "http://snomed.info/sct",
            "code": "8392000",
            "display": "Non-smoker (finding)"
          }
        ],
        "text": "Non-smoker"
      },
      "referenceRange": [
        //this range is artificial but it provides and preserves the 2 possible coded values that the clinician can choose from.
        {
          "low": {
            "system": "http://snomed.info/sct",
            "code": "8392000",
            "display": "Non-smoker (finding)"
          },
          "type": {
            "text": "Non-smoker"
          }
        },
        {
          "high": {
            "system": "http://snomed.info/sct",
            "code": "77176002",
            "display": "Smoker (finding)"
          },
          "type": {
            "text": "Smoker"
          }
        }
      ]
    },
    "comorbidities": {
      "resourceType": "Bundle",
      "id": "comorbiditiesBundle",
      "type": "collection",
      "entry": [
        {
          "resource": {
            "resourceType": "Condition",
            "id": "cvd",
            "code": {
              "coding": [
                {
                  "system": "http://snomed.info/sct",
                  "code": "49601007",
                  "display": "Disorder of cardiovascular system (disorder)"
                }
              ],
              "text": "Cvd"
            },
            "subject": {
              "reference": "Patient/1677163"
            },
            "recordedDate": "2020-10-26T18:00:00+01:00"
          }
        },
        {
          "resource": {
            "resourceType": "Condition",
            "id": "ckd",
            "code": {
              "coding": [
                {
                  "system": "http://snomed.info/sct",
                  "code": "709044004",
                  "display": "Chronic kidney disease (disorder)"
                }
              ],
              "text": "Ckd"
            },
            "subject": {
              "reference": "Patient/1677163"
            },
            "recordedDate": "2020-10-26T18:00:00+01:00"
          }
        }
      ]
    },
    "immunizationStatus": {
      "resourceType": "Bundle",
      "id": "immunizationStatusBundle",
      "type": "collection",
      "entry": [
        {
          "resource": {
            "resourceType": "Immunization",
            "id": "influenza_immunization",
            "status": "completed", //range of values: completed | not-done
            "vaccineCode": {
              "coding": [
                //to be confirmed by Emma/Ella
                {
                  "system": "http://snomed.info/sct",
                  "code": "1181000221105",
                  "display": "Vaccine product containing only Influenza virus antigen (medicinal product)"
                }
              ],
              "text": "flu vaccine"
            },
            "occurrenceDateTime": "2020-10-26T18:00:00+01:00" //if 'not-done', this field is discarded
          }
        },
        {
          "resource": {
            "resourceType": "Immunization",
            "id": "pneumococcal_immunization",
            "status": "not-done",
            "vaccineCode": {
              "coding": [
                {
                  "system": "http://snomed.info/sct", //to be confirmed
                  "code": "333598008",
                  "display": "Pneumococcal vaccine (product)"
                }
              ],
              "text": "Pneumococcal vaccine"
            }
          }
        }
      ]
    },
    "copdAssessment": {
      "resourceType": "Bundle",
      "id": "copdAssessmentBundle",
			"type": "collection",
      "entry": [
        {
          "resource": {
            "resourceType": "Observation",
            "id": "copd_group_curr",
            "status": "preliminary",
            "code": {
              "coding": [ //coded values in this resource to be confirmed by Emma/Ella
                {
                  "system": "http://snomed.info/sct",
                  "code": "1097861000000108",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group (observable entity)"
                }
              ],
              "text": "Copd group"
            },
            "valueCodeableConcept": {
              "coding": [
                {
                  "system": "http://snomed.info/sct",
                  "code": "1097871000000101",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group A (finding)"
                }
              ],
              "text": "Copd group A"
            },
            "effectiveDateTime": "2018-03-11T16:07:54+00:00",
            "referenceRange": [
              {
                "low": {
                  "system": "http://snomed.info/sct",
                  "code": "1097871000000101",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group A (finding)"
                },
                "type": {
                  "text": "Copd group A"
                }
              },
              {
                "low": {
                  "system": "http://snomed.info/sct",
                  "code": "1097881000000104",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group B (finding)"
                },
                "type": {
                  "text": "Copd group B"
                }
              },
              {
                "high": {
                  "system": "http://snomed.info/sct",
                  "code": "1097891000000102",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group C (finding)"
                },
                "type": {
                  "text": "Copd group C"
                }
              },
              {
                "high": {
                  "system": "http://snomed.info/sct",
                  "code": "1097901000000101",
                  "display": "Global Initiative for Chronic Obstructive Lung Disease 2017 group D (finding)"
                },
                "type": {
                  "text": "Copd group D"
                }
              }
            ]
          }
        },
        {
          "resourceType": "Bundle", //to Jovana: Ive changed the type from CarePlan becuase Medications contained in this resource will not be part of the same care plan. In fact, they are meant to be included in a care plan with at most 1 of them.
          "id": "selected_treatments", 
          "type": "collection",
          "entry": [ //by default it must have all the medications suggested by the DSS as a response to hook copd-assess, plus any other COPD medication the clinician selects.
            {
              "resourceType": "Medication",
              "id": "DrugTLaba",
              "code": {
                "coding": [
                  {
                    "system": "http://anonymous.org/data/DrugTLaba",
                    "code": "Laba",
                    "display": "administer LABA"
                  }
                ]
              }
            },
            {
              "resourceType": "Medication",
              "id": "DrugTLama",
              "code": {
                "coding": [
                  {
                    "system": "http://anonymous.org/data/DrugTLama",
                    "code": "Lama",
                    "display": "administer LAMA"
                  }
                ]
              }
            },
            {
              "resourceType": "Medication",
              "id": "DrugCatLabaLama",
              "code": {
                "coding": [
                  {
                    "system": "http://anonymous.org/data/DrugCatLabaLama",
                    "code": "LabaLama",
                    "display": "administer a combination of LABA and LAMA"
                  }
                ]
              }
            }
          ]
        }
      ]
    },
    "selectedMedications": ["Medication/DrugTLaba"] //This list includes references to all copd drugs the clinician has selected to submit to the DSS. 
  }                                                 //So, in this example, DSS provides a personalised care plan which includes LABA medication but also takes into account the other drugs not selected when giving info to the clinician
}                                                    // If list empty (hence not added to hook instance), by default all Medications in Bundle/selected_treatments are taken as selected. Hence, we are looking at the suggestions made by the DSS in the first place. Ideally this should not happen as the clinician should pick at least one or more
